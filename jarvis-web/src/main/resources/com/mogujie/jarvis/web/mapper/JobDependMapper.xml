<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mogujie.jarvis.web.mapper.JobDependMapper">

    <select id="getJobById" parameterType="Long" resultType="JobDependVo">
        SELECT job.jobId
              ,job.jobName
              ,job.status
              ,jobType
              ,job.submitUser
              ,job.priority
              ,job.bizGroupId
              ,job.activeStartDate
              ,job.activeEndDate
              ,app.appName
              ,app.appKey
              ,biz_group.name as bizGroupName
        FROM job
        LEFT JOIN app ON job.appId=app.appId
        LEFT JOIN biz_group on job.bizGroupId = biz_group.id
        WHERE jobId=#{jobId}
    </select>

    <select id="getChildrenById" parameterType="Long" resultType="JobDependVo">
        SELECT job_depend.jobId
              ,job.jobName
              ,job.status
              ,jobType
              ,job.submitUser
              ,job.priority
              ,job.bizGroupId
              ,job.activeStartDate
              ,job.activeEndDate
              ,app.appName
              ,app.appKey
              ,biz_group.name as bizGroupName
        FROM job_depend
        LEFT JOIN job ON job_depend.jobId=job.jobId
        LEFT JOIN app ON job.appId=app.appId
        LEFT JOIN biz_group on job.bizGroupId = biz_group.id
        WHERE job_depend.preJobId=#{jobId}
    </select>

    <select id="getParentById" parameterType="Long" resultType="JobDependVo">
        SELECT job_depend.preJobId as jobId
              ,job.jobName
              ,job.status
              ,jobType
              ,job.submitUser
              ,job.priority
              ,job.bizGroupId
              ,job.activeStartDate
              ,job.activeEndDate
              ,app.appName
              ,app.appKey
              ,biz_group.name as bizGroupName
              ,job_depend.commonStrategy
              ,job_depend.offsetStrategy
        FROM job_depend
        LEFT JOIN job ON job_depend.preJobId=job.jobId
        LEFT JOIN app ON job.appId=app.appId
        LEFT JOIN biz_group on job.bizGroupId = biz_group.id
        WHERE job_depend.jobId=#{_parameter}
    </select>

</mapper>